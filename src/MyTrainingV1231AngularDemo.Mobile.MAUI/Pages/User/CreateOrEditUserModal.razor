@inherits ModalBase
<div class="modal fade" id="@ModalId" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded">
            <div class="modal-body scroll-y pt-10 pb-10">
                @if (_isInitialized)
                {
                    <div class="btn btn-sm btn-icon btn-active-color-primary position-absolute" style="top:20px;right:20px" data-bs-dismiss="modal">
                        <span class="svg-icon svg-icon-1">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect opacity="0.5" x="6" y="17.3137" width="16" height="2" rx="1" transform="rotate(-45 6 17.3137)" fill="currentColor"></rect>
                                <rect x="7.41422" y="6" width="16" height="2" rx="1" transform="rotate(45 7.41422 6)" fill="currentColor"></rect>
                            </svg>
                        </span>
                    </div>

                    <div class="card p-0 m-0">
                        <div class="card-body d-flex flex-center flex-column p-0 m-0">
                            <div class="symbol symbol-65px symbol-circle mb-3">
                                <img src="@Model.Photo">
                            </div>
                            <a href="#" class="fs-4 text-gray-800 text-hover-primary fw-bold mb-0">
                                @Model.User.UserName
                            </a>
                            <div class="fw-semibold text-gray-400 mb-6"> @(Model.FullName)</div>
                        </div>
                    </div>

                    <div class="card shadow-sm p-0 m-0">
                        <div class="card-body d-flex flex-column py-10 m-0">
                            <div class="d-flex flex-column mb-8 fv-row fv-plugins-icon-container ">
                                <label class="d-flex align-items-center fs-6 fw-semibold mb-2">
                                    <span class="required">
                                        @L("UserNameOrEmail")
                                    </span>
                                    <i class="fas fa-exclamation-circle ms-2 fs-7"></i>
                                </label>
                                <input type="text" class="form-control form-control-solid" @bind="Model.User.UserName" />
                            </div>
                            <div class="d-flex flex-column mb-8 fv-row fv-plugins-icon-container min-w-90">
                                <label class="d-flex align-items-center fs-6 fw-semibold mb-2">
                                    <span class="required">
                                        @L("Name")
                                    </span>
                                    <i class="fas fa-exclamation-circle ms-2 fs-7"></i>
                                </label>
                                <input type="text" class="form-control form-control-solid" @bind="Model.User.Name" />
                            </div>
                            <div class="d-flex flex-column mb-8 fv-row fv-plugins-icon-container min-w-90">
                                <label class="d-flex align-items-center fs-6 fw-semibold mb-2">
                                    <span class="required">
                                        @L("Surname")
                                    </span>
                                    <i class="fas fa-exclamation-circle ms-2 fs-7"></i>
                                </label>
                                <input type="text" class="form-control form-control-solid" @bind="Model.User.Surname" />
                            </div>
                            <div class="d-flex flex-column mb-8 fv-row fv-plugins-icon-container min-w-90">
                                <label class="d-flex align-items-center fs-6 fw-semibold mb-2">
                                    <span class="required">
                                        @L("EmailAddress")
                                    </span>
                                    <i class="fas fa-exclamation-circle ms-2 fs-7"></i>
                                </label>
                                <input type="text" class="form-control form-control-solid" @bind="Model.User.EmailAddress" />
                            </div>
                            <div class="d-flex flex-column fv-row fv-plugins-icon-container min-w-90">
                                <label class="d-flex align-items-center fs-6 fw-semibold mb-2">
                                    <span class="required">
                                        @L("PhoneNumber")
                                    </span>
                                    <i class="fas fa-exclamation-circle ms-2 fs-7"></i>
                                </label>
                                <input type="text" class="form-control form-control-solid" @bind="Model.User.PhoneNumber" />
                            </div>
                        </div>
                    </div>

                    <div class="card shadow-sm p-0 m-0 mt-8">
                        <div class="card-body d-flex flex-column py-10 m-0">
                            <label class="form-check form-switch form-check-custom form-check-solid mb-8">
                                <input type="checkbox" class="form-check-input" @bind="SetRandomPassword"></input>
                                <span class="form-check-label fw-semibold text-muted">@L("SetRandomPassword")</span>
                            </label>
                            @if (!SetRandomPassword)
                            {
                                <div class="d-flex flex-column mb-8 fv-row fv-plugins-icon-container min-w-90">
                                    <label class="d-flex align-items-center fs-6 fw-semibold mb-2">
                                        <span class="required">
                                            @L("NewPassword")
                                        </span>
                                        <i class="fas fa-exclamation-circle ms-2 fs-7"></i>
                                    </label>
                                    <input type="text" class="form-control form-control-solid" @bind="Model.User.Password" />
                                </div>
                                <div class="d-flex flex-column mb-8 fv-row fv-plugins-icon-container min-w-90">
                                    <label class="d-flex align-items-center fs-6 fw-semibold mb-2">
                                        <span class="required">
                                            @L("NewPasswordRepeat")
                                        </span>
                                        <i class="fas fa-exclamation-circle ms-2 fs-7"></i>
                                    </label>
                                    <input type="text" class="form-control form-control-solid" @bind="_newPasswordRepeat" />
                                </div>
                            }

                            <label class="form-check form-switch form-check-custom form-check-solid mb-8">
                                <input type="checkbox" class="form-check-input" @bind="Model.User.ShouldChangePasswordOnNextLogin"></input>
                                <span class="form-check-label fw-semibold text-muted">@L("ShouldChangePasswordOnNextLogin")</span>
                            </label>
                            <label class="form-check form-switch form-check-custom form-check-solid mb-8">
                                <input type="checkbox" class="form-check-input" @bind="UserInput.SendActivationEmail"></input>
                                <span class="form-check-label fw-semibold text-muted">@L("SendActivationEmail")</span>
                            </label>
                            <label class="form-check form-switch form-check-custom form-check-solid mb-8">
                                <input type="checkbox" class="form-check-input" @bind="Model.User.IsLockoutEnabled"></input>
                                <span class="form-check-label fw-semibold text-muted">@L("IsLockoutEnabled")</span>
                            </label>
                            <label class="form-check form-switch form-check-custom form-check-solid mb-8">
                                <input type="checkbox" class="form-check-input" @bind="Model.User.IsActive"></input>
                                <span class="form-check-label fw-semibold text-muted">@L("Active")</span>
                            </label>
                        </div>
                    </div>

                    @if (Model.Roles.Length > 0)
                    {
                        <div class="card shadow-sm p-0 m-0 mt-8">
                            <div class="card-header">
                                <h3 class="card-title align-items-start flex-column">
                                    <span class="card-label fw-bold text-dark">@L("Roles")</span>
                                </h3>
                            </div>

                            <div class="card-body d-flex flex-column py-5 m-0">

                                @for (int i = 0; i < Model.Roles.Length; i++)
                                {
                                    var role = Model.Roles[i];
                                    <label class="form-check form-switch form-check-custom form-check-solid @((i<Model.Roles.Length? "mb-3" : ""))">
                                        <input type="checkbox" class="form-check-input w-45px h-30px" @bind="role.IsAssigned"></input>
                                        <span class="form-check-label fw-semibold text-muted">@role.RoleDisplayName</span>
                                    </label>
                                }
                            </div>
                        </div>
                    }

                    @if (Model.OrganizationUnits.Count > 0)
                    {
                        <div class="card shadow-sm p-0 m-0 mt-8">
                            <div class="card-header">
                                <h3 class="card-title align-items-start flex-column">
                                    <span class="card-label fw-bold text-dark">@L("OrganizationUnits")</span>
                                </h3>
                            </div>

                            <div class="card-body d-flex flex-column py-5 m-0">

                                @for (int i = 0; i < Model.OrganizationUnits.Count; i++)
                                {
                                    var ou = Model.OrganizationUnits[i];
                                    <label class="form-check form-switch form-check-custom form-check-solid @((i<(Model.OrganizationUnits.Count)? "mb-1" : ""))">
                                        <span class="form-check-label fw-semibold w-100 text-start">
                                            <span class="text-muted">@OUCodeIntentConverter(ou.Code)</span>
                                            @ou.DisplayName
                                        </span>
                                        <input type="checkbox" class="form-check-input w-45px h-30px" @bind="ou.IsAssigned"></input>
                                    </label>
                                }
                            </div>
                        </div>
                    }

                    @if (!IsNewUser)
                    {
                        <div class="card shadow-sm p-0 m-0 mt-8">
                            <div class="card-body d-flex flex-column py-10 m-0">
                                <div class="row">
                                    <div class="col">
                                        <label class="fs-6 fw-semibold">
                                            @L("EmailConfirm")
                                        </label>
                                    </div>
                                    <div class="col">
                                        @if (Model.IsEmailConfirmed)
                                        {
                                            <span class="badge badge-success ng-tns-c260-35 ng-star-inserted"> @L("Yes") </span>
                                        }
                                        else
                                        {
                                            <span class="badge badge-dark ng-tns-c260-35 ng-star-inserted"> @L("No") </span>
                                        }
                                    </div>
                                </div>
                                <hr />
                                <div class="row">
                                    <div class="col">
                                        <span class="fs-6 fw-semibold">
                                            @L("CreationTime")
                                        </span>
                                    </div>
                                    <div class="col">
                                        @Model.CreationTime.ToShortDateString()
                                    </div>
                                </div>
                            </div>
                        </div>
                    }

                    @if (_isDeleteButtonVisible || _isUnlockButtonVisible)
                    {
                        <div class="card shadow-sm p-0 m-0 mt-8">
                            <div class="card-body d-flex flex-column py-10 m-0">
                                <div class="row">
                                    <button type="button" class="btn btn-warning col" @onclick="UnlockUser">
                                        <span class="indicator-label">@L("Unlock")</span>
                                    </button>
                                </div>
                                <div class="row mt-3">
                                    <button type="button" class="btn btn-danger col" @onclick="DeleteUser">
                                        <span class="indicator-label">@L("Delete")</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    }

                    <div class="text-center mt-8">
                        <button type="reset" data-dismiss="modal" class="btn btn-light me-3" @onclick="Hide">@L("Cancel")</button>
                        <button type="button" class="btn btn-primary" @onclick="SaveUser">
                            <span class="indicator-label">@L("Save")</span>
                        </button>
                    </div>
                }
            </div>
        </div>
    </div>
</div>
